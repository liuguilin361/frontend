{
  "version": 3,
  "sources": ["../../@sjsf/form/dist/lib/svelte.svelte.js", "../../@sjsf/form/dist/fields/extra-fields/file.svelte", "../../@sjsf/form/dist/fields/extra-fields/file-include.js"],
  "sourcesContent": ["import { abortPrevious, createAction } from \"./action.svelte.js\";\nexport function createAsyncBinding({ initialOutput, getInput, setInput, toInput, toOutput, isEqual = Object.is, }) {\n    let lastInputUpdate;\n    const toInputAction = createAction({\n        combinator: abortPrevious,\n        execute: toInput,\n        onSuccess(result) {\n            lastInputUpdate = result;\n            setInput(result);\n        },\n    });\n    let output = $state.raw(initialOutput);\n    const toOutputAction = createAction({\n        combinator: abortPrevious,\n        execute: toOutput,\n        onSuccess(result) {\n            output = result;\n        },\n    });\n    $effect(() => {\n        const input = getInput();\n        if (isEqual(input, lastInputUpdate)) {\n            return;\n        }\n        toInputAction.abort();\n        toOutputAction.run(input);\n    });\n    return {\n        get current() {\n            return output;\n        },\n        set current(v) {\n            toOutputAction.abort();\n            toInputAction.run(v);\n        },\n        get inputProcessing() {\n            return toInputAction.isProcessed;\n        },\n        get outputProcessing() {\n            return toOutputAction.isProcessed;\n        },\n    };\n}\n", "<script lang=\"ts\" module>\n  declare module \"../../form/index.js\" {\n    interface FoundationalComponents {\n      fileWidget: {};\n    }\n  }\n</script>\n\n<script lang=\"ts\">\n  import { fileToDataURL } from \"../../lib/file.js\";\n  import { createAsyncBinding } from \"../../lib/svelte.svelte.js\";\n  import {\n    makeEventHandlers,\n    getErrors,\n    validateField,\n    getFormContext,\n    addFile,\n    getComponent,\n    type ComponentProps,\n  } from \"../../form/index.js\";\n  import \"../../form/extra-fields/file.js\";\n\n  import \"../extra-widgets/file.js\";\n\n  let {\n    config,\n    value = $bindable(),\n    uiOption,\n  }: ComponentProps[\"fileField\"] = $props();\n\n  const ctx = getFormContext();\n\n  const Template = $derived(getComponent(ctx, \"fieldTemplate\", config));\n  const widgetType = \"fileWidget\";\n  const Widget = $derived(getComponent(ctx, widgetType, config));\n\n  const handlers = makeEventHandlers(ctx, () =>\n    validateField(ctx, config, value)\n  );\n\n  const files = createAsyncBinding({\n    initialOutput: undefined,\n    getInput: () => value,\n    setInput: (v) => (value = v),\n    async toOutput(signal, value) {\n      const data = new DataTransfer();\n      if (value !== undefined) {\n        await addFile(ctx, signal, data, value);\n      }\n      return data.files;\n    },\n    async toInput(signal, files) {\n      return files === undefined || files.length === 0\n        ? undefined\n        : fileToDataURL(signal, files[0]!);\n    },\n  });\n\n  const errors = $derived(getErrors(ctx, config.id));\n</script>\n\n<Template\n  type=\"template\"\n  showTitle\n  useLabel\n  {uiOption}\n  {widgetType}\n  {value}\n  {config}\n  {errors}\n>\n  <Widget\n    type=\"widget\"\n    bind:value={files.current}\n    processing={files.inputProcessing}\n    loading={files.outputProcessing}\n    {uiOption}\n    {handlers}\n    {errors}\n    {config}\n    multiple={false}\n  />\n</Template>\n", "import { definitions } from \"../resolver/definitions.js\";\nimport File from \"./file.svelte\";\nimport \"./file.svelte\";\ndefinitions.fileField = File;\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;SACgB;EAAqB;EAAe;EAAU;EAAU;EAAS;EAAU,UAAU,OAAO;GAAO;MAC3G;QACE,gBAAgB,aAAY;IAC9B,YAAY;IACZ,SAAS;IACT,UAAU,QAAQ;AACd,wBAAkB;AAClB,eAAS,MAAM;IACnB;;MAEA,SAAM,IAAA,MAAc,aAAa,GAAA,QAAA;QAC/B,iBAAiB,aAAY;IAC/B,YAAY;IACZ,SAAS;IACT,UAAU,QAAQ;UACd,QAAS,MAAM;IACnB;;AAEJ,EAAA,YAAO,MAAO;UACJ,QAAQ,SAAQ;QAClB,QAAQ,OAAO,eAAe,GAAG;;IAErC;AACA,kBAAc,MAAK;AACnB,mBAAe,IAAI,KAAK;EAC5B,CAAC;;QAEO,UAAU;iBACH,MAAM;IACjB;QACI,QAAQ,GAAG;AACX,qBAAe,MAAK;AACpB,oBAAc,IAAI,CAAC;IACvB;QACI,kBAAkB;aACX,cAAc;IACzB;QACI,mBAAmB;aACZ,eAAe;IAC1B;;AAER;;;;;;;MChBI,QAAK,KAAA,SAAA,SAAA,EAAA;QAID,MAAM,eAAc;QAEpB,WAAQ,IAAA,aAAA,MAAY,aAAa,KAAK,iBAAe,QAAA,MAAA,CAAA,GAAA,UAAA;QACrD,aAAa;QACb,SAAM,IAAA,aAAA,MAAY,aAAa,KAAK,YAAU,QAAA,MAAA,CAAA,GAAA,QAAA;QAE9C,WAAW,kBAAkB,KAAG,MACpC,cAAc,KAAG,QAAA,QAAU,MAAK,CAAA,CAAA;QAG5B,QAAQ,mBAAkB;IAC9B,eAAe;IACf,UAAQ,MAAQ,MAAK;IACrB,UAAQ,CAAG,MAAO,MAAQ,CAAC;UACrB,SAAS,QAAQA,QAAO;YACtB,OAAI,IAAO,aAAY;wBACzBA,QAAU,QAAS,KAAA,GAAE;cACjB,QAAQ,KAAK,QAAQ,MAAMA,MAAK;MACxC;aACO,KAAK;IACd;UACM,QAAQ,QAAQC,QAAO;2BACpBA,QAAU,MAAS,KAAA,cAAIA,OAAM,QAAW,CAAA,IAC3C,SACA,cAAc,QAAQA,OAAM,CAAC,CAAA;IACnC;;QAGI,SAAM,IAAA,aAAA,MAAY,UAAU,KAAG,QAAA,OAAS,EAAE,CAAA,GAAA,QAAA;;;;;;;;;;;;;;;;;;;;;;;;6DAelC,OAAK,MAAA,WAAA,IAAA,CAAA;;;;;qBACL,MAAM;;;qBACT,MAAM;;;;;;;;;;;;;;sBAKL;;qBAPE,MAAM;;;AAAN,oBAAM,UAAO;;;;;;;;;;;;;;;;;;;;;;ACtE7B,YAAY,YAAY;",
  "names": ["value", "files"]
}
